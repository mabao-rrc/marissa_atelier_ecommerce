<%# ------------------------------------------------------ %>
<%# Product Show Page – Feature 2.3                        %>
<%# Displays detailed info about a single product          %>
<%# ------------------------------------------------------ %>

<div class="product-show">

  <%# -------------------------- %>
  <%# Product Image              %>
  <%# -------------------------- %>
  <% if @product.image_url.present? %>
    <%= image_tag @product.image_url, alt: @product.name, class: "product-show-image mb-4" %>
  <% end %>

  <%# -------------------------- %>
  <%# Product Name               %>
  <%# -------------------------- %>
  <h1 class="mb-3" style="color: #896629; font-family: 'Cormorant Garamond', serif;">
    <%= @product.name %>
  </h1>

  <%# -------------------------- %>
  <%# Product Description        %>
  <%# -------------------------- %>
  <p class="product-description">
    <%= @product.description %>
  </p>

  <%# -------------------------- %>
  <%# Product Price              %>
  <%# -------------------------- %>
  <p class="product-price mt-3">
    <strong>Price:</strong> <%= number_to_currency(@product.price) %>
  </p>

  <%# -------------------------- %>
  <%# Add to Cart Button         %>
  <%# -------------------------- %>
  <div class="mt-3">
    <%= button_to "Add to Cart", add_item_cart_path(product_id: @product.id), method: :post, class: "btn btn-primary" %>
  </div>

  <%# -------------------------- %>
  <%# Product Categories         %>
  <%# -------------------------- %>
  <% if @product.categories.any? %>
    <p class="mt-3" style="color: #404040;">
      <strong>Categories:</strong> <%= @product.categories.map(&:name).join(', ') %>
    </p>
  <% end %>

  <%# -------------------------- %>
  <%# Customer Reviews Section   %>
  <%# -------------------------- %>
  <div class="mt-5">
    <h3 style="font-family: 'Cormorant Garamond', serif; color: #1a1a1a;">Customer Reviews</h3>

    <% if @product.reviews.any? %>
      <%= render partial: 'reviews/review', collection: @product.reviews, as: :review %>
    <% else %>
      <p style="color: #404040;">No reviews yet.</p>
    <% end %>
  </div>

  <%# -------------------------- %>
  <%# New Review Form            %>
  <%# -------------------------- %>
  <div class="mt-5">
    <h4 style="font-family: 'Cormorant Garamond', serif; color: #1a1a1a;">Leave a Review</h4>

    <%= form_with(model: [@product, Review.new], local: true) do |form| %>
      <div class="mb-3">
        <%= form.label :rating, "Rating (1–5)", class: "form-label" %>
        <%= form.number_field :rating, in: 1..5, class: "form-control", required: true %>
      </div>

      <div class="mb-3">
        <%= form.label :comment, "Comment", class: "form-label" %>
        <%= form.text_area :comment, rows: 3, class: "form-control", required: true %>
      </div>

      <%= form.submit "Submit Review", class: "btn btn-atelier" %>
    <% end %>
  </div>

  <%# -------------------------- %>
  <%# Back to Storefront Button  %>
  <%# -------------------------- %>
  <div class="mt-4">
    <%= link_to '← Back to All Products', root_path, class: 'btn btn-atelier' %>
  </div>

</div>
