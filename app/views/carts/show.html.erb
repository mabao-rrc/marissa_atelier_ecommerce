<%# ------------------------------------------------------ %>
<%# Cart Show Page â€“ Feature 3.1.1                         %>
<%# Displays items added to the cart                      %>
<%# ------------------------------------------------------ %>

<h1 class="mb-4" style="font-family: 'Cormorant Garamond', serif; color: #896629;">Your Cart</h1>

<% if @cart_items.any? %>
  <table class="table">
    <thead>
      <tr>
        <th>Product</th>
        <th>Quantity</th>
        <th>Unit Price</th>
        <th>Subtotal</th>
        <th>Actions</th> <%# Add this column for the Remove button %>
      </tr>
    </thead>
    <tbody>
      <% @cart_items.each do |item| %>
        <tr>
          <td><%= item[:product].name %></td>
          <td>
            <%= form_with url: update_item_cart_path, method: :post, local: true do %>
              <%= hidden_field_tag :product_id, item[:product].id %>
              <%= number_field_tag :quantity, item[:quantity], min: 1, class: "form-control form-control-sm", style: "width: 70px; display: inline-block;" %>
              <%= submit_tag "Update", class: "btn btn-sm btn-outline-primary mt-1" %>
            <% end %>
          </td>
          <td><%= number_to_currency(item[:product].price) %></td>
          <td><%= number_to_currency(item[:product].price * item[:quantity]) %></td>
          <td>
            <%= button_to "Remove", remove_item_cart_path(product_id: item[:product].id), method: :post, class: "btn btn-sm btn-danger" %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <%= link_to "Continue Shopping", root_path, class: "btn btn-secondary me-2" %>
  <%= link_to "Checkout", checkout_path, class: "btn btn-primary" %>

<% else %>
  <p>Your cart is currently empty.</p>
  <%= link_to "Browse Products", root_path, class: "btn btn-primary" %>
<% end %>
